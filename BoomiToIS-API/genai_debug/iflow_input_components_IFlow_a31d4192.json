{
  "process_name": "SAP SuccessFactors to SFTP Integration with Error Handling",
  "description": "This integration facilitates the secure transfer of employee data from SAP SuccessFactors to an SFTP server with comprehensive error handling capabilities. The integration extracts data from SuccessFactors, transforms it into the required format, and delivers it to a designated SFTP location while providing robust error notification mechanisms.",
  "endpoints": [
    {
      "method": "GET",
      "path": "/successfactors/employee-data",
      "purpose": "Extract employee data from SAP SuccessFactors, transform it, and send to SFTP server",
      "components": [
        {
          "type": "request_reply",
          "name": "SAP SuccessFactors Request",
          "id": "successfactors_request",
          "config": {
            "adapter_type": "SAP SuccessFactors",
            "operation": "Query(GET)",
            "authentication": "OAuth",
            "timeout": "30000"
          }
        },
        {
          "type": "groovy_script",
          "name": "Error Handler",
          "id": "error_handler",
          "config": {
            "script_type": "exception_handling",
            "log_level": "ERROR",
            "notification_enabled": true,
            "notification_recipients": "${error.notification.emails}",
            "retry_count": 3,
            "retry_interval": 60000
          }
        },
        {
          "type": "request_reply",
          "name": "SFTP Connection",
          "id": "sftp_connection",
          "config": {
            "adapter_type": "SFTP",
            "operation": "Write",
            "host": "${sftp.host}",
            "port": "22",
            "authentication": "Username/Password",
            "directory_path": "${sftp.directory}",
            "file_naming_pattern": "employee_data_${date:yyyyMMdd_HHmmss}.json"
          }
        },
        {
          "type": "enricher",
          "name": "Validate Response",
          "id": "validate_response",
          "config": {
            "validation_type": "schema",
            "error_handling": "throw_exception"
          }
        },
        {
          "type": "groovy_script",
          "name": "Transform Data to Target Format",
          "id": "transform_data",
          "config": {
            "script_type": "mapping",
            "mapping_name": "Canonical To Kafka Avro",
            "field_mappings": [
              {
                "source": "9",
                "target": "Root/Object/batchProcessingDirectives/Object/accountID/Object/username",
                "type": "profile"
              },
              {
                "source": "91",
                "target": "Root/Object/batchContactList/Array/ArrayElement1/Object/contact/Array/ArrayElement1/Object/contactID",
                "type": "profile"
              },
              {
                "source": "111",
                "target": "Root/Object/batchContactList/Array/ArrayElement1/Object/contact/Array/ArrayElement1/Object/contactPointList/Array/ArrayElement1/Object/contactPoint/Array/ArrayElement1/Object/type",
                "type": "profile"
              },
              {
                "source": "118",
                "target": "Root/Object/batchProcessingDirectives/Object/batchProcessingOption/Array/ArrayElement1/Object/name",
                "type": "profile"
              }
            ]
          }
        }
      ],
      "sequence": [
        "successfactors_request",
        "validate_response",
        "transform_data",
        "sftp_connection"
      ],
      "transformations": [
        {
          "source_format": "JSON",
          "target_format": "JSON",
          "mapping": "Canonical To Kafka Avro"
        }
      ],
      "sequence_flows": [
        {
          "id": "SequenceFlow_Start",
          "source": "successfactors_request",
          "target": "error_handler",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_Start\" sourceRef=\"successfactors_request\" targetRef=\"error_handler\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_1",
          "source": "error_handler",
          "target": "sftp_connection",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_1\" sourceRef=\"error_handler\" targetRef=\"sftp_connection\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_2",
          "source": "sftp_connection",
          "target": "validate_response",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_2\" sourceRef=\"sftp_connection\" targetRef=\"validate_response\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_End",
          "source": "validate_response",
          "target": "transform_data",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_End\" sourceRef=\"validate_response\" targetRef=\"transform_data\" isImmediate=\"true\"/>"
        }
      ]
    }
  ]
}