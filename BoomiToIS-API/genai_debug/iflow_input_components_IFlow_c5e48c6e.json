{
  "process_name": "SAP SuccessFactors to SFTP Integration",
  "description": "This integration connects SAP SuccessFactors with an SFTP server, enabling the automated transfer of employee data with comprehensive error handling.",
  "endpoints": [
    {
      "method": "GET",
      "path": "/SuccessFactors/EmployeeData",
      "purpose": "Retrieves employee data from SAP SuccessFactors",
      "components": [
        {
          "type": "request_reply",
          "name": "SAP_SuccessFactors_Request",
          "id": "sf_request_1",
          "config": {
            "method": "GET",
            "url": "https://api.successfactors.com/odata/v2/User",
            "headers": {
              "Content-Type": "application/json",
              "Authorization": "Bearer ${token}"
            },
            "authentication": "OAuth"
          }
        },
        {
          "type": "enricher",
          "name": "Log_Success",
          "id": "log_success_1",
          "config": {
            "message": "Successfully transferred employee data to SFTP",
            "level": "INFO"
          }
        },
        {
          "type": "enricher",
          "name": "Log_Connection_Error",
          "id": "log_connection_error_1",
          "config": {
            "message": "Error connecting to SAP SuccessFactors",
            "level": "ERROR"
          }
        },
        {
          "type": "enricher",
          "name": "Log_Data_Validation_Error",
          "id": "log_data_validation_error_1",
          "config": {
            "message": "Invalid data received from SAP SuccessFactors",
            "level": "ERROR"
          }
        },
        {
          "type": "enricher",
          "name": "Log_Transfer_Error",
          "id": "log_transfer_error_1",
          "config": {
            "message": "Error transferring data to SFTP server",
            "level": "ERROR"
          }
        },
        {
          "type": "request_reply",
          "name": "SFTP_Upload",
          "id": "sftp_upload_1",
          "config": {
            "protocol": "SFTP",
            "operation": "PUT",
            "host": "sftp.example.com",
            "port": 22,
            "path": "/uploads/employeedata/employeeData_${date}.json",
            "authentication": {
              "type": "Password",
              "username": "${sftp_username}"
            }
          }
        },
        {
          "type": "request_reply",
          "name": "Send_Error_Notification",
          "id": "send_notification_1",
          "config": {
            "method": "POST",
            "url": "${notification_service_endpoint}",
            "headers": {
              "Content-Type": "application/json"
            },
            "body": {
              "errorType": "${error.type}",
              "errorMessage": "${error.message}",
              "timestamp": "${now}",
              "processId": "${process.id}",
              "severity": "HIGH"
            }
          }
        },
        {
          "type": "enricher",
          "name": "Validate_Response",
          "id": "validate_response_1",
          "config": {
            "condition": "message.body != null"
          }
        },
        {
          "type": "enricher",
          "name": "Transform_Data",
          "id": "transform_data_1",
          "config": {
            "mapping": "Canonical To Kafka Avro",
            "mappings": [
              {
                "source": "profile.field[9]",
                "target": "Root.Object.batchProcessingDirectives.Object.accountID.Object.username"
              },
              {
                "source": "profile.field[91]",
                "target": "Root.Object.batchContactList.Array.ArrayElement1.Object.contact.Array.ArrayElement1.Object.contactID"
              },
              {
                "source": "profile.field[111]",
                "target": "Root.Object.batchContactList.Array.ArrayElement1.Object.contact.Array.ArrayElement1.Object.contactPointList.Array.ArrayElement1.Object.contactPoint.Array.ArrayElement1.Object.type"
              },
              {
                "source": "profile.field[118]",
                "target": "Root.Object.batchProcessingDirectives.Object.batchProcessingOption.Array.ArrayElement1.Object.name"
              }
            ]
          }
        }
      ],
      "sequence": [
        "sf_request_1",
        "validate_response_1",
        "transform_data_1",
        "sftp_upload_1",
        "log_success_1"
      ],
      "transformations": [
        {
          "name": "Canonical To Kafka Avro",
          "source_format": "JSON",
          "target_format": "JSON",
          "description": "Transforms SuccessFactors employee data to the required format for SFTP upload"
        }
      ],
      "sequence_flows": [
        {
          "id": "SequenceFlow_Start",
          "source": "sf_request_1",
          "target": "log_success_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_Start\" sourceRef=\"sf_request_1\" targetRef=\"log_success_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_1",
          "source": "log_success_1",
          "target": "log_connection_error_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_1\" sourceRef=\"log_success_1\" targetRef=\"log_connection_error_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_2",
          "source": "log_connection_error_1",
          "target": "log_data_validation_error_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_2\" sourceRef=\"log_connection_error_1\" targetRef=\"log_data_validation_error_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_3",
          "source": "log_data_validation_error_1",
          "target": "log_transfer_error_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_3\" sourceRef=\"log_data_validation_error_1\" targetRef=\"log_transfer_error_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_4",
          "source": "log_transfer_error_1",
          "target": "sftp_upload_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_4\" sourceRef=\"log_transfer_error_1\" targetRef=\"sftp_upload_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_5",
          "source": "sftp_upload_1",
          "target": "send_notification_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_5\" sourceRef=\"sftp_upload_1\" targetRef=\"send_notification_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_6",
          "source": "send_notification_1",
          "target": "validate_response_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_6\" sourceRef=\"send_notification_1\" targetRef=\"validate_response_1\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_End",
          "source": "validate_response_1",
          "target": "transform_data_1",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_End\" sourceRef=\"validate_response_1\" targetRef=\"transform_data_1\" isImmediate=\"true\"/>"
        }
      ]
    }
  ]
}