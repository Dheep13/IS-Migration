{
  "process_name": "SAP SuccessFactors to SFTP Integration with Error Handling",
  "description": "This integration solution connects SAP SuccessFactors with an SFTP server, enabling the automated transfer of employee data while implementing comprehensive error handling mechanisms.",
  "endpoints": [
    {
      "method": "GET",
      "path": "/successfactors/employee-data",
      "purpose": "Retrieve employee data from SuccessFactors, transform it, and transfer to SFTP",
      "components": [
        {
          "type": "request_reply",
          "name": "SAP SuccessFactors OData Request",
          "id": "sf_odata_request",
          "config": {
            "adapter_type": "OData",
            "operation": "Query(GET)",
            "resource_path": "User",
            "authentication": "OAuth",
            "content_type": "application/json"
          }
        },
        {
          "type": "enricher",
          "name": "Data Validation",
          "id": "data_validation",
          "config": {
            "validation_rules": "Required fields check"
          }
        },
        {
          "type": "enricher",
          "name": "Canonical To Kafka Avro Mapping",
          "id": "canonical_to_avro_mapping",
          "config": {
            "mappings": [
              {
                "source": "profile field 9",
                "target": "Root/Object/batchProcessingDirectives/Object/accountID/Object/username"
              },
              {
                "source": "profile field 91",
                "target": "Root/Object/batchContactList/Array/ArrayElement1/Object/contact/Array/ArrayElement1/Object/contactID"
              },
              {
                "source": "profile field 111",
                "target": "Root/Object/batchContactList/Array/ArrayElement1/Object/contact/Array/ArrayElement1/Object/contactPointList/Array/ArrayElement1/Object/contactPoint/Array/ArrayElement1/Object/type"
              },
              {
                "source": "profile field 118",
                "target": "Root/Object/batchProcessingDirectives/Object/batchProcessingOption/Array/ArrayElement1/Object/name"
              }
            ]
          }
        },
        {
          "type": "groovy_script",
          "name": "Error Handler",
          "id": "error_handler",
          "config": {
            "script_purpose": "Handle validation errors and route to error notification"
          }
        },
        {
          "type": "groovy_script",
          "name": "SFTP Error Handler",
          "id": "sftp_error_handler",
          "config": {
            "retry_logic": "Configurable retry attempts",
            "max_retries": 3
          }
        },
        {
          "type": "groovy_script",
          "name": "Success Logger",
          "id": "success_logger",
          "config": {
            "log_level": "INFO",
            "message": "Successfully transferred employee data to SFTP"
          }
        },
        {
          "type": "request_reply",
          "name": "SFTP File Transfer",
          "id": "sftp_transfer",
          "config": {
            "adapter_type": "SFTP",
            "operation": "PUT",
            "host": "${SFTP_HOST}",
            "port": "22",
            "authentication": "Username/Password",
            "directory": "${SFTP_DIRECTORY}",
            "file_naming": "EmployeeData_${date.now()}.json"
          }
        },
        {
          "type": "request_reply",
          "name": "Error Notification",
          "id": "error_notification",
          "config": {
            "adapter_type": "Mail",
            "operation": "Send",
            "recipient": "${ERROR_EMAIL}",
            "subject": "SAP SuccessFactors to SFTP Integration Error",
            "body_template": "Error occurred during integration: ${error.message}"
          }
        }
      ],
      "sequence": [
        "sf_odata_request",
        "data_validation",
        "canonical_to_avro_mapping",
        "sftp_transfer",
        "success_logger"
      ],
      "transformations": [
        {
          "source": "SuccessFactors data structure",
          "target": "Kafka Avro format",
          "mapping": "canonical_to_avro_mapping"
        }
      ],
      "sequence_flows": [
        {
          "id": "SequenceFlow_Start",
          "source": "sf_odata_request",
          "target": "data_validation",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_Start\" sourceRef=\"sf_odata_request\" targetRef=\"data_validation\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_1",
          "source": "data_validation",
          "target": "canonical_to_avro_mapping",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_1\" sourceRef=\"data_validation\" targetRef=\"canonical_to_avro_mapping\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_2",
          "source": "canonical_to_avro_mapping",
          "target": "error_handler",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_2\" sourceRef=\"canonical_to_avro_mapping\" targetRef=\"error_handler\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_3",
          "source": "error_handler",
          "target": "sftp_error_handler",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_3\" sourceRef=\"error_handler\" targetRef=\"sftp_error_handler\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_4",
          "source": "sftp_error_handler",
          "target": "success_logger",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_4\" sourceRef=\"sftp_error_handler\" targetRef=\"success_logger\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_5",
          "source": "success_logger",
          "target": "sftp_transfer",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_5\" sourceRef=\"success_logger\" targetRef=\"sftp_transfer\" isImmediate=\"true\"/>"
        },
        {
          "id": "SequenceFlow_End",
          "source": "sftp_transfer",
          "target": "error_notification",
          "is_immediate": true,
          "xml_content": "<bpmn2:sequenceFlow id=\"SequenceFlow_End\" sourceRef=\"sftp_transfer\" targetRef=\"error_notification\" isImmediate=\"true\"/>"
        }
      ]
    }
  ]
}